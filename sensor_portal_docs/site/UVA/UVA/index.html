<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>UVA management - ARISE MDS sensor portal help</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "UVA management";
        var mkdocs_page_input_path = "UVA\\UVA.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> ARISE MDS sensor portal help
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../about/">About</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Data structure</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../structure/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../structure/project/">Project</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../structure/device/">Device</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../structure/deployment/">Deployment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../structure/datafile/">Datafile</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Model detail</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../structure/detail/site/">Site</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../structure/detail/datatype/">DataType</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../structure/detail/project/">Project</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../structure/detail/devicemodel/">DeviceModel</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../structure/detail/device/">Device</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../structure/detail/deployment/">Deployment</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../structure/detail/datafile/">DataFile</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../structure/detail/taxon/">Taxon</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../structure/detail/observation/">Observation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../structure/detail/datapackage/">DataPackage</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/">Index</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/arise_mds_api_examples/">Examples</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/upload_data_workflow/">Upload example</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">For developers</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../developers/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../developers/data_handlers/">Data handlers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../developers/generic_jobs/">Generic jobs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Code Reference</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../reference/ai_integration/">ai_integration</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/ai_integration/tasks/">tasks</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../reference/archiving/">archiving</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/archiving/bagit_functions/">bagit_functions</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/archiving/functions/">functions</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/archiving/models/">models</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/archiving/tar_functions/">tar_functions</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/archiving/tasks/">tasks</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../reference/camtrap_dp_export/">camtrap_dp_export</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/camtrap_dp_export/metadata_functions/">metadata_functions</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/camtrap_dp_export/querysets/">querysets</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/camtrap_dp_export/serializers/">serializers</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/camtrap_dp_export/viewsets/">viewsets</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../reference/data_handlers/">data_handlers</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_handlers/base_data_handler_class/">base_data_handler_class</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_handlers/functions/">functions</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_handlers/post_upload_task_handler/">post_upload_task_handler</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_handlers/serializers/">serializers</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_handlers/tasks/">tasks</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_handlers/viewsets/">viewsets</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../reference/data_models/">data_models</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_models/file_handling_functions/">file_handling_functions</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_models/filtersets/">filtersets</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_models/general_functions/">general_functions</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_models/job_handling_functions/">job_handling_functions</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_models/metadata_functions/">metadata_functions</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_models/models/">models</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_models/plotting_functions/">plotting_functions</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_models/rules/">rules</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_models/serializers/">serializers</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_models/signals/">signals</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_models/tasks/">tasks</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_models/validators/">validators</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_models/viewsets/">viewsets</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../reference/data_packages/">data_packages</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_packages/create_zip_functions/">create_zip_functions</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_packages/models/">models</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_packages/serializers/">serializers</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_packages/tasks/">tasks</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/data_packages/viewsets/">viewsets</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../reference/dsi/">dsi</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/dsi/api_client/">api_client</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/dsi/api_functions/">api_functions</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/dsi/tasks/">tasks</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../reference/external_storage_import/">external_storage_import</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/external_storage_import/filtersets/">filtersets</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/external_storage_import/models/">models</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/external_storage_import/serializers/">serializers</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/external_storage_import/tasks/">tasks</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/external_storage_import/viewsets/">viewsets</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../reference/observation_editor/">observation_editor</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/observation_editor/filtersets/">filtersets</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/observation_editor/GBIF_functions/">GBIF_functions</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/observation_editor/metadata_functions/">metadata_functions</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/observation_editor/models/">models</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/observation_editor/rules/">rules</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/observation_editor/serializers/">serializers</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/observation_editor/tasks/">tasks</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/observation_editor/viewsets/">viewsets</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../reference/user_management/">user_management</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/user_management/filtersets/">filtersets</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/user_management/models/">models</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/user_management/rules/">rules</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/user_management/serializers/">serializers</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/user_management/signals/">signals</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/user_management/views/">views</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/user_management/viewsets/">viewsets</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../reference/utils/">utils</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/utils/api_renderer/">api_renderer</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/utils/email/">email</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/utils/filtersets/">filtersets</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/utils/general/">general</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/utils/models/">models</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/utils/paginators/">paginators</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/utils/perm_functions/">perm_functions</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/utils/querysets/">querysets</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/utils/rules/">rules</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/utils/serializers/">serializers</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/utils/ssh_client/">ssh_client</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/utils/task_functions/">task_functions</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/utils/test_functions/">test_functions</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/utils/validators/">validators</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/utils/views/">views</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/utils/viewsets/">viewsets</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >uva_jobs</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../reference/uva_jobs/tasks/">tasks</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">For admin</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../../admin/">Overview</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">UVA management</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#basic-access">Basic access</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#ssh-into-the-server-you-must-be-on-a-university-network-to-do-this">SSH into the server (you must be on a university network to do this)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#switch-to-podman-user">Switch to podman user:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#view-running-containers">View running containers:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#stop-all-containers">Stop all containers:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#start-all-containers">Start all containers:</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#view-logs-and-other-useful-information">View logs and other useful information</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#follow-logs-of-celery-worker-or-backened-container-using-logs-followed-by-arguments-and-the-container-name">Follow logs of celery worker or backened container using logs, followed by arguments and the container name</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#use-grep-to-filter-logs">Use grep to filter logs</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#find-errors">Find errors:</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#follow-a-certain-process-id-live">Follow a certain process ID live:</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#check-running-jobs">Check running jobs</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#see-all-celery-jobs-and-arguments">See all celery jobs and arguments:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#see-just-the-essential-details">See just the essential details:</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#update-containers">Update containers</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#switch-to-source-code-directory">Switch to source code directory:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#get-latest-version-of-the-source-code">Get latest version of the source code:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#rebuild-container-images">Rebuild container images:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#stop-existing-containers">Stop existing containers.</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#start-containers-using-the-new-images">Start containers using the new images</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#updaterestart-ultralytics-celery">Update/Restart ultralytics celery</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#switch-to-ultralytics-celery-directory">Switch to ultralytics-celery directory</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#get-latest-version-of-the-source-code_1">Get latest version of the source code:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#rebuild-container-images_1">Rebuild container images:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#stop-existing-containers_1">Stop existing containers.</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#start-containers-using-the-new-images_1">Start containers using the new images</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#check-the-ultralytics-celery-queue-is-on-the-same-network-as-the-rest-of-the-containers">Check the ultralytics celery queue is on the same network as the rest of the containers</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#execute-python-code-inside-the-containers">Execute python code inside the containers</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#enter-the-container">Enter the container</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#run-your-python-code">Run your python code</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#carry-out-a-database-query">Carry out a database query</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#import-models">import models</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#start-a-job">Start a job</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#import-tasks">import tasks</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#run-it-asynchronously">Run it asynchronously</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#run-a-task-with-arguments">Run a task with arguments</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#executing-other-code-inside-the-containers">Executing other code inside the containers</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../admin/permissions/">Permissions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Admin only models details</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../admin/detail/projectjob/">Project Job</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../admin/detail/data_storage_input/">Data Storage input</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../admin/detail/archive/">Archive</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../admin/detail/tarfile/">TAR file</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">ARISE MDS sensor portal help</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">For admin</li>
      <li class="breadcrumb-item active">UVA management</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="uva-container-orchestration-instructions">UVA CONTAINER ORCHESTRATION INSTRUCTIONS</h1>
<h2 id="basic-access">Basic access</h2>
<h5 id="ssh-into-the-server-you-must-be-on-a-university-network-to-do-this">SSH into the server (you must be on a university network to do this)</h5>
<h5 id="switch-to-podman-user">Switch to podman user:</h5>
<pre><code class="language-bash">sudo -su podman
</code></pre>
<h5 id="view-running-containers">View running containers:</h5>
<pre><code class="language-bash">podman ps -a
</code></pre>
<h5 id="stop-all-containers">Stop all containers:</h5>
<pre><code class="language-bash">podman-compose down
</code></pre>
<h5 id="start-all-containers">Start all containers:</h5>
<pre><code class="language-bash">podman-compose up -d
</code></pre>
<p>The <code>-d</code> flag means the process will run detached, not takining over your console.</p>
<h2 id="view-logs-and-other-useful-information">View logs and other useful information</h2>
<h4 id="follow-logs-of-celery-worker-or-backened-container-using-logs-followed-by-arguments-and-the-container-name">Follow logs of celery worker or backened container using logs, followed by arguments and the container name</h4>
<pre><code class="language-bash">podman logs arise-mds-sensor-portal_sensor_portal_django_1
</code></pre>
<pre><code class="language-bash">podman logs -f --tail 1000 arise-mds-sensor-portal_sensor_portal_worker_1
</code></pre>
<p>The <code>-f</code> flag means the logs are followed live and the <code>--tail</code> flag means only the last 1000 lines are returned.</p>
<h3 id="use-grep-to-filter-logs">Use grep to filter logs</h3>
<h4 id="find-errors">Find errors:</h4>
<pre><code class="language-bash">podman logs arise-mds-sensor-portal_sensor_portal_django_1 2&gt;&amp;1 | grep ERROR -B 10
</code></pre>
<p>The <code>-B</code> flag will return lines before the string match</p>
<h4 id="follow-a-certain-process-id-live">Follow a certain process ID live:</h4>
<pre><code class="language-bash">podman logs -f --tail 100 arise-mds-sensor-portal_sensor_portal_worker_1 2&gt;&amp;1 | grep pid:60
</code></pre>
<h2 id="check-running-jobs">Check running jobs</h2>
<h5 id="see-all-celery-jobs-and-arguments">See all celery jobs and arguments:</h5>
<pre><code class="language-bash">podman exec arise-mds-sensor-portal_sensor_portal_django_1 celery inspect active 

</code></pre>
<h5 id="see-just-the-essential-details">See just the essential details:</h5>
<p>Just running celery inspect active can flood your terminal with all the arguments being used in the jobs (which might be many many files). We can filter the output using grep so as to just see the task names.</p>
<pre><code class="language-bash">podman exec arise-mds-sensor-portal_sensor_portal_django_1 celery inspect active | grep -o 'type.*' | cut -f2- -d:

</code></pre>
<h2 id="update-containers">Update containers</h2>
<h5 id="switch-to-source-code-directory">Switch to source code directory:</h5>
<pre><code class="language-bash">cd /home/podman/ARISE-MDS-sensor-portal/
</code></pre>
<h5 id="get-latest-version-of-the-source-code">Get latest version of the source code:</h5>
<pre><code class="language-bash">git pull
</code></pre>
<h5 id="rebuild-container-images">Rebuild container images:</h5>
<p>This may take a little time</p>
<pre><code class="language-bash">podman-compose build
</code></pre>
<h5 id="stop-existing-containers">Stop existing containers.</h5>
<pre><code class="language-bash">podman-compose down
</code></pre>
<h5 id="start-containers-using-the-new-images">Start containers using the new images</h5>
<pre><code class="language-bash">podman-compose up -d
</code></pre>
<h2 id="updaterestart-ultralytics-celery">Update/Restart ultralytics celery</h2>
<p>The ultralytics celery container is optional, but is neccesary to carry out AI inference. It runs on the same network as the other containers, but has its own docker-compose file.</p>
<h5 id="switch-to-ultralytics-celery-directory">Switch to ultralytics-celery directory</h5>
<pre><code>cd /home/podman/ultralytics_celery
</code></pre>
<h5 id="get-latest-version-of-the-source-code_1">Get latest version of the source code:</h5>
<pre><code class="language-bash">git pull
</code></pre>
<h5 id="rebuild-container-images_1">Rebuild container images:</h5>
<p>This may take a little time</p>
<pre><code class="language-bash">podman-compose build
</code></pre>
<h5 id="stop-existing-containers_1">Stop existing containers.</h5>
<pre><code class="language-bash">podman-compose down
</code></pre>
<h5 id="start-containers-using-the-new-images_1">Start containers using the new images</h5>
<pre><code class="language-bash">podman-compose up -d
</code></pre>
<h5 id="check-the-ultralytics-celery-queue-is-on-the-same-network-as-the-rest-of-the-containers">Check the ultralytics celery queue is on the same network as the rest of the containers</h5>
<pre><code class="language-bash">podman exec arise-mds-sensor-portal_sensor_portal_django_1 celery inspect active 

</code></pre>
<h2 id="execute-python-code-inside-the-containers">Execute python code inside the containers</h2>
<h5 id="enter-the-container">Enter the container</h5>
<pre><code class="language-bash">podman exec -it arise-mds-sensor-portal_sensor_portal_django_1 python manage.py shell
</code></pre>
<p>The <code>-it</code> flag indicates we want to run this session interactively.</p>
<h5 id="run-your-python-code">Run your python code</h5>
<pre><code class="language-python">print(&quot;Hello world, I am inside the container&quot;)
</code></pre>
<h3 id="carry-out-a-database-query">Carry out a database query</h3>
<h4 id="import-models">import models</h4>
<pre><code class="language-python">from data_models.models import DataFile
</code></pre>
<h5 id="carry-out-a-simple-query">Carry out a simple query</h5>
<pre><code class="language-python">my_query = DataFile.objects.filter(local_storage=True)
print(my_query)
# do stuff with your query
</code></pre>
<p>See Django documentation for more details.</p>
<h3 id="start-a-job">Start a job</h3>
<h5 id="import-tasks">import tasks</h5>
<pre><code class="language-python">from data_models.tasks import check_device_status
</code></pre>
<h5 id="run-it-asynchronously">Run it asynchronously</h5>
<pre><code class="language-python">check_device_status.apply_async()
</code></pre>
<p>You will receive an async result, meaning that this task is now running on the celery workers.</p>
<h5 id="run-a-task-with-arguments">Run a task with arguments</h5>
<p>Often we want to run these jobs with arguments. A common pattern in this system is to pass the primary keys <code>pk</code> of objects that the job is to run on.</p>
<pre><code class="language-python">from data_models.models import DataFile
from dsi.tasks import push_to_dsi_task
# Filter wildlife camera files by those stored locally, and created after a certain date
file_objs = DataFile.objects.filter(file_type__name=&quot;wildlifecamera&quot;, local_storage=True,
created_on__gte=&quot;2025-06-30&quot;)

# Get the primary keys of these files as a flat list
file_pks = file_objs.values_list('pk',flat=True)

# Django querysets are not JSON serializable, so convert to a normal python list
file_pks = list(file_pks)

# Other arguments
dsi_project_id = 202
dsi_site_id = 2
dsi_sensor_model_id = 2

# Start the async job to push files to ARISE DSI
push_to_dsi_task.apply_async([file_pks, dsi_project_id, dsi_site_id, dsi_sensor_model_id])

</code></pre>
<p>See celery documentation for more details on how to run tasks.</p>
<h2 id="executing-other-code-inside-the-containers">Executing other code inside the containers</h2>
<p>You can also enter the OS of the container by running <code>bash</code> instead of <code>python manage.py shell</code>, after which you can carry out This may be neccesary to execute database migrations.</p>
<pre><code class="language-bash">podman exec -it arise-mds-sensor-portal_sensor_portal_django_1 bash
</code></pre>
<p>You will now be inside the container</p>
<pre><code class="language-bash">ls # Will list files in the container home directory 
</code></pre>
<pre><code class="language-bash">python manage.py shell # Enter the python shell as above
</code></pre>
<pre><code class="language-bash">python manage.py migrate # Run migrations on the database
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../admin/" class="btn btn-neutral float-left" title="Overview"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../admin/permissions/" class="btn btn-neutral float-right" title="Permissions">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../admin/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../admin/permissions/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
